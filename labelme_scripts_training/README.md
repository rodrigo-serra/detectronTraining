# Detectron Training
1) Get a dataset and split it in train and test images. Create two separate directories. One for the training and another for testing;

2) Label images using labelme app or any other labeling app. Do it for the train and test images;

3) Run the labelme2coco.py script to convert the train and test images into COCO format. Run in the same directory where the train and test folders are.

    ```bash
    python3 labelme2coco.py train --output train.json
    python3 labelme2coco.py test --output test.json
    ```

    The script will generate the train.json and the test.json files;

4) Run the trainDetectron.py. Make the configurations are the ones you need. Before training the model, we recommend testing the dataset by running the plot_samples() function;

5) Run the testDetectron.py script to test the model on a few images or video;

6) Load the model in the detectron2 node and make sure it works;


Notes:

The folder structure must be the one illustrated below. One must prepare a dataset directory where the test and train folders exist. Note that the test.json and train.json files are the ones generated by the labelme2coco.py script as described in step 2).

The model directory is the generated by the training script in step 4). This folder must be copied to the detectron2 directory as mentioned in step 6).



```bash
.
├── dataset
│   ├── test
│   │   ├── img_21.json
│   │   ├── img_21.png
│   │   ├── img_22.json
│   │   ├── img_22.png
│   │   ├── img_23.json
│   │   ├── img_23.png
│   ├── test.json
│   ├── train
│   │   ├── img_0.json
│   │   ├── img_0.png
│   │   ├── img_10.json
│   │   ├── img_10.png
│   │   ├── img_11.json
│   │   ├── img_11.png
│   │   ├── img_12.json
│   │   ├── img_12.png
│   └── train.json
├── labelme2coco.py
├── model
│   ├── dataset_metadata.json
│   ├── IS_cfg.pickle
│   └── output
│       └── instance_segmentation
│           ├── events.out.tfevents.1675938979.6e88c4b466e0.217.0
│           ├── last_checkpoint
│           ├── metrics.json
│           └── model_final.pth
├── README.md
├── testDetectron.py
├── trainDetectron.py
└── utilsDetectron.py
```